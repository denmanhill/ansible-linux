---
- hosts: AnsibleHost
  gather_facts: no
  vars:
  tasks:
  - name: Stop Elasticsearch
    docker_container:
      name: elasticsearch
      state: stopped
  
  - name: Backup Elasticsearch
    command: "{{ item }}"
    with_items:
      - rclone copy /SINGLEPOOL/home/config/Elasticsearch googledrive:files/config/Elasticsearch
   
  - name: Start Elasticsearch
    docker_container:
      name: elasticsearch
      state: started      
      
  - name: Backup all other config files
    command: "{{ item }}"
    with_items:
      - rclone copy /SINGLEPOOL/home/config/pihole googledrive:files/config/pihole
      - rclone copy /SINGLEPOOL/home/config/guacamole googledrive:files/config/guacamole
      - rclone copy /SINGLEPOOL/home/config/guacamole googledrive:files/config/guacd
      - rclone copy /SINGLEPOOL/home/config/heimdall googledrive:files/config/heimdall
      - rclone copy /SINGLEPOOL/home/config/sonarr googledrive:files/config/sonarr
      - rclone copy /SINGLEPOOL/home/config/portainer googledrive:files/config/portainer
      - rclone copy /SINGLEPOOL/home/config/grafana googledrive:files/config/grafana
      - rclone copy /SINGLEPOOL/home/config/traefik googledrive:files/config/traefik
      - rclone copy /SINGLEPOOL/home/config/telegraf googledrive:files/config/telegraf
      - rclone copy /SINGLEPOOL/home/config/tautulli googledrive:files/config/tautulli
      - rclone copy /SINGLEPOOL/home/config/radarr googledrive:files/config/radarr
      - rclone copy /SINGLEPOOL/home/config/cloudflare-ddns googledrive:files/config/cloudflare-ddns
      - rclone copy /SINGLEPOOL/home/config/filebeat googledrive:files/config/filebeat

